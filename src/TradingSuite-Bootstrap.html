<!DOCTYPE html>
<html lang="de" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>6bot Enhanced Trading Suite - Bootstrap 5 Dark Mode</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    
    <!-- Custom Trading Theme -->
    <style>
        :root {
            --bs-dark: #0a0a0a;
            --bs-dark-rgb: 10, 10, 10;
            --trading-primary: #00ffff;
            --trading-success: #00ff00;
            --trading-warning: #ffaa00;
            --trading-danger: #ff4444;
            --trading-purple: #ff6b6b;
            --card-bg: rgba(26, 26, 26, 0.95);
            --border-glow: rgba(0, 255, 255, 0.3);
        }
        
        body {
            background: linear-gradient(135deg, #0a0a0a, #1a1a1a, #0f0f2a, #1a0a1a);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            color: #ffffff;
            overflow-x: hidden;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Glasmorphism Cards */
        .card {
            background: rgba(26, 26, 26, 0.25);
            border: 1px solid rgba(0, 255, 255, 0.18);
            border-radius: 20px;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow: 
                0 8px 32px 0 rgba(0, 255, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                inset 0 -1px 0 rgba(0, 0, 0, 0.1);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.05), transparent);
            transition: left 0.5s;
        }
        
        .card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 
                0 20px 60px 0 rgba(0, 255, 255, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                0 0 40px rgba(0, 255, 255, 0.1);
            border-color: rgba(0, 255, 255, 0.3);
        }
        
        .card:hover::before {
            left: 100%;
        }
        
        .card-primary { border-color: var(--trading-primary); }
        .card-success { border-color: var(--trading-success); }
        .card-warning { border-color: var(--trading-warning); }
        .card-danger { border-color: var(--trading-danger); }
        
        /* Trading Status Indicators */
        .status-indicator {
            position: relative;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--trading-success);
            animation: pulse 2s infinite;
        }
        
        .status-dot.warning { background: var(--trading-warning); }
        .status-dot.danger { background: var(--trading-danger); }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.3; transform: scale(1.1); }
        }
        
        /* Enhanced Buttons */
        .btn-trading-primary {
            background: linear-gradient(45deg, var(--trading-primary), #0088aa);
            border: none;
            color: #000000;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
        }
        
        .btn-trading-primary:hover {
            background: linear-gradient(45deg, #00dddd, var(--trading-primary));
            transform: translateY(-2px);
            box-shadow: 0 0 25px rgba(0, 255, 255, 0.5);
            color: #000000;
        }
        
        .btn-trading-success {
            background: linear-gradient(45deg, var(--trading-success), #00cc00);
            border: none;
            color: #000000;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.3);
        }
        
        .btn-trading-success:hover {
            background: linear-gradient(45deg, #00ff44, var(--trading-success));
            transform: translateY(-2px);
            box-shadow: 0 0 25px rgba(0, 255, 0, 0.5);
            color: #000000;
        }
        
        .btn-trading-danger {
            background: linear-gradient(45deg, var(--trading-danger), #cc0000);
            border: none;
            color: #ffffff;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 0 15px rgba(255, 68, 68, 0.3);
        }
        
        .btn-trading-danger:hover {
            background: linear-gradient(45deg, #ff6666, var(--trading-danger));
            transform: translateY(-2px);
            box-shadow: 0 0 25px rgba(255, 68, 68, 0.5);
            color: #ffffff;
        }
        
        /* Auto-Trading Panel - Glasmorphism */
        .auto-trading-panel {
            background: rgba(0, 255, 0, 0.05);
            border: 2px solid rgba(0, 255, 0, 0.2);
            border-radius: 25px;
            padding: 2rem;
            margin-bottom: 2rem;
            text-align: center;
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            box-shadow: 
                0 12px 40px rgba(0, 255, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.1),
                0 0 60px rgba(0, 255, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .auto-trading-panel::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(0, 255, 0, 0.03) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .trading-status-display {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 1rem 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .trading-status-display.active { color: var(--trading-success); }
        .trading-status-display.inactive { color: var(--trading-danger); }
        
        /* Strategy Selection */
        .strategy-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .strategy-card {
            background: rgba(42, 42, 42, 0.8);
            border: 2px solid #555;
            border-radius: 10px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .strategy-card:hover {
            border-color: var(--trading-primary);
            background: rgba(0, 255, 255, 0.1);
        }
        
        .strategy-card.selected {
            border-color: var(--trading-primary);
            background: rgba(0, 255, 255, 0.15);
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }
        
        /* Tables */
        .table-dark {
            --bs-table-bg: rgba(26, 26, 26, 0.8);
            --bs-table-striped-bg: rgba(42, 42, 42, 0.5);
            --bs-table-hover-bg: rgba(0, 255, 255, 0.1);
            border: 1px solid rgba(0, 255, 255, 0.3);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .table-dark th {
            border-color: rgba(0, 255, 255, 0.3);
            color: var(--trading-primary);
            font-weight: bold;
        }
        
        .table-dark td {
            border-color: rgba(255, 255, 255, 0.1);
        }
        
        /* Glasmorphism Watchlist */
        .watchlist-item {
            background: rgba(42, 42, 42, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
        }
        
        .watchlist-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 2px;
            transition: left 0.3s ease;
        }
        
        .watchlist-item:hover {
            background: rgba(0, 255, 255, 0.1);
            border-color: rgba(0, 255, 255, 0.3);
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 255, 255, 0.1);
        }
        
        .watchlist-item.positive::before {
            background: var(--trading-success);
        }
        
        .watchlist-item.negative::before {
            background: var(--trading-danger);
        }
        
        .watchlist-item:hover::before {
            left: 0;
        }
        
        /* Glasmorphism Metrics */
        .metric-card {
            background: rgba(42, 42, 42, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 1.5rem;
            text-align: center;
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
        }
        
        .metric-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        }
        
        .metric-card:hover {
            transform: translateY(-8px) rotateY(5deg);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
            border-color: rgba(0, 255, 255, 0.3);
        }
        
        /* Chart Container */
        .chart-container {
            background: rgba(10, 10, 10, 0.3);
            border: 1px solid rgba(0, 255, 255, 0.2);
            border-radius: 20px;
            padding: 1.5rem;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            margin: 1rem 0;
            position: relative;
            overflow: hidden;
        }
        
        .chart-container::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, 
                rgba(0, 255, 255, 0.1), 
                rgba(0, 255, 0, 0.1), 
                rgba(255, 170, 0, 0.1), 
                rgba(255, 68, 68, 0.1));
            border-radius: 20px;
            z-index: -1;
            animation: borderGlow 3s ease-in-out infinite alternate;
        }
        
        @keyframes borderGlow {
            0% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            margin: 0.5rem 0;
        }
        
        .metric-change {
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .text-trading-primary { color: var(--trading-primary) !important; }
        .text-trading-success { color: var(--trading-success) !important; }
        .text-trading-warning { color: var(--trading-warning) !important; }
        .text-trading-danger { color: var(--trading-danger) !important; }
        
        /* Glasmorphism Header */
        .trading-header {
            background: rgba(17, 17, 17, 0.8);
            border-bottom: 1px solid rgba(0, 255, 255, 0.3);
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }
        
        /* Glasmorphism Navigation */
        .nav-pills .nav-link {
            background: rgba(42, 42, 42, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: #ffffff;
            margin: 0 0.25rem;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            position: relative;
            overflow: hidden;
        }
        
        .nav-pills .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .nav-pills .nav-link:hover {
            background: rgba(0, 255, 255, 0.15);
            border-color: rgba(0, 255, 255, 0.3);
            color: #ffffff;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 255, 255, 0.1);
        }
        
        .nav-pills .nav-link:hover::before {
            left: 100%;
        }
        
        .nav-pills .nav-link.active {
            background: rgba(0, 255, 255, 0.2);
            border-color: var(--trading-primary);
            color: #ffffff;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
        }
        
        /* Grok AI Cards */
        .grok-card {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            border-left: 5px solid;
            transition: all 0.3s ease;
        }
        
        .grok-card.buy { border-left-color: var(--trading-success); }
        .grok-card.hold { border-left-color: var(--trading-warning); }
        .grok-card.sell { border-left-color: var(--trading-danger); }
        
        .grok-card:hover {
            transform: translateX(5px);
        }
        
        /* Dark Mode Toggle */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1050;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .trading-header {
                padding: 0.5rem;
            }
            
            .auto-trading-panel {
                padding: 1rem;
            }
            
            .strategy-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Loading animations */
        .loading-shimmer {
            background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.1), transparent);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
    </style>
</head>
<body>
    <!-- Theme Toggle Button -->
    <div class="theme-toggle">
        <button class="btn btn-outline-light btn-sm" onclick="toggleTheme()">
            <i class="bi bi-moon-fill" id="theme-icon"></i>
        </button>
    </div>

    <!-- Header -->
    <header class="trading-header">
        <div class="container-fluid">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <div class="d-flex align-items-center gap-4">
                        <div class="status-indicator">
                            <div class="status-dot"></div>
                            <span class="fw-bold text-trading-success">System ONLINE</span>
                        </div>
                        <div class="text-trading-primary fw-bold">Portfolio: $109,329.05 (+2.67%)</div>
                        <div class="text-trading-success fw-bold">ML Accuracy: 87.3%</div>
                        <div class="text-trading-warning fw-bold">Grok Signals: 8 Active</div>
                    </div>
                </div>
                <div class="col-md-4 text-end">
                    <span class="badge bg-warning text-dark fs-6">PAPER TRADING MODE</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="navbar navbar-dark bg-dark sticky-top">
        <div class="container-fluid justify-content-center">
            <ul class="nav nav-pills">
                <li class="nav-item">
                    <a class="nav-link active" data-bs-toggle="pill" href="#dashboard">
                        <i class="bi bi-house-fill"></i> Dashboard
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="pill" href="#portfolio">
                        <i class="bi bi-briefcase-fill"></i> Portfolio
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="pill" href="#ml">
                        <i class="bi bi-robot"></i> ML Models
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="pill" href="#grok">
                        <i class="bi bi-brain"></i> Grok AI
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-bs-toggle="pill" href="#trading">
                        <i class="bi bi-graph-up"></i> Trading
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Auto-Trading Control Panel -->
    <div class="container-fluid my-4">
        <div class="auto-trading-panel">
            <h2 class="text-trading-primary mb-4">
                <i class="bi bi-robot"></i> AUTONOMOUS TRADING SYSTEM
            </h2>
            
            <div class="trading-status-display inactive" id="tradingStatus">
                <div class="status-dot danger" id="tradingLed"></div>
                <span id="tradingText">⏸️ AUTO-TRADING GESTOPPT</span>
            </div>
            
            <div class="alert alert-info" role="alert" id="backendStatus">
                <i class="bi bi-wifi"></i> <span id="backendStatusText">Backend Connecting...</span>
                <button class="btn btn-sm btn-outline-light ms-2" onclick="testBackendConnection()" title="Test Backend Connection">
                    <i class="bi bi-arrow-clockwise"></i>
                </button>
            </div>
            
            <button class="btn btn-trading-success btn-lg px-5 py-3" id="startTradingBtn" onclick="toggleAutoTradingReal()">
                <i class="bi bi-play-fill"></i> TRADING STARTEN
            </button>
            
            <div class="strategy-grid mt-4">
                <div class="strategy-card selected" onclick="selectStrategy('CONSERVATIVE')">
                    <h5 class="text-trading-primary"><i class="bi bi-shield-check"></i> CONSERVATIVE</h5>
                    <p class="mb-1">3% Position Size</p>
                    <small class="text-muted">Low Risk, Steady Growth</small>
                </div>
                <div class="strategy-card" onclick="selectStrategy('BALANCED')">
                    <h5 class="text-trading-warning"><i class="bi bi-balance"></i> BALANCED</h5>
                    <p class="mb-1">5% Position Size</p>
                    <small class="text-muted">Moderate Risk & Reward</small>
                </div>
                <div class="strategy-card" onclick="selectStrategy('AGGRESSIVE')">
                    <h5 class="text-trading-danger"><i class="bi bi-rocket"></i> AGGRESSIVE</h5>
                    <p class="mb-1">10% Position Size</p>
                    <small class="text-muted">High Risk, High Reward</small>
                </div>
            </div>
            
            <div class="mt-4">
                <button class="btn btn-trading-danger" onclick="emergencyStopReal()">
                    <i class="bi bi-stop-circle-fill"></i> EMERGENCY STOP ALL TRADING
                </button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container-fluid">
        <div class="row">
            <!-- Main Content Area -->
            <div class="col-lg-9">
                <div class="tab-content">
                    <!-- Dashboard -->
                    <div class="tab-pane fade show active" id="dashboard">
                        <h1 class="text-trading-primary mb-4">
                            <i class="bi bi-house-fill"></i> DASHBOARD OVERVIEW
                        </h1>
                        
                        <div class="row g-4 mb-4">
                            <div class="col-md-4">
                                <div class="metric-card card-primary">
                                    <h6 class="text-muted"><i class="bi bi-briefcase"></i> Portfolio Value</h6>
                                    <div class="metric-value text-trading-primary">$109,329.05</div>
                                    <div class="metric-change text-trading-success">+$2,847.23 (+2.67%)</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="metric-card card-success">
                                    <h6 class="text-muted"><i class="bi bi-robot"></i> ML Performance</h6>
                                    <div class="metric-value text-trading-success">87.3%</div>
                                    <div class="metric-change text-muted">Accuracy (LSTM)</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="metric-card card-warning">
                                    <h6 class="text-muted"><i class="bi bi-brain"></i> Grok Signals</h6>
                                    <div class="metric-value text-trading-warning">8</div>
                                    <div class="metric-change text-muted">Active Recommendations</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Live Charts Row -->
                <div class="row g-4 mb-4">
                    <div class="col-lg-8">
                        <div class="chart-container">
                            <h5 class="text-trading-primary mb-3">
                                <i class="bi bi-graph-up-arrow"></i> Portfolio Performance (24H)
                            </h5>
                            <canvas id="portfolioChart" height="300"></canvas>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="chart-container">
                            <h5 class="text-trading-success mb-3">
                                <i class="bi bi-pie-chart"></i> Asset Allocation
                            </h5>
                            <canvas id="allocationChart" height="300"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- Trading Activity Chart -->
                <div class="row g-4 mb-4">
                    <div class="col-12">
                        <div class="chart-container">
                            <h5 class="text-trading-warning mb-3">
                                <i class="bi bi-bar-chart-line"></i> Trading Volume & ML Predictions
                            </h5>
                            <canvas id="tradingChart" height="200"></canvas>
                        </div>
                    </div>
                </div>

                <div class="card">
                            <div class="card-body">
                                <h5 class="card-title text-trading-primary">
                                    <i class="bi bi-lightning-fill"></i> QUICK ACTIONS
                                </h5>
                                <div class="d-flex gap-3 justify-content-center">
                                    <button class="btn btn-trading-success">
                                        <i class="bi bi-cart-plus"></i> Quick Buy
                                    </button>
                                    <button class="btn btn-trading-danger">
                                        <i class="bi bi-currency-dollar"></i> Quick Sell
                                    </button>
                                    <button class="btn btn-trading-primary">
                                        <i class="bi bi-arrow-repeat"></i> Rebalance
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Portfolio -->
                    <div class="tab-pane fade" id="portfolio">
                        <h1 class="text-trading-primary mb-4">
                            <i class="bi bi-briefcase-fill"></i> PORTFOLIO MANAGEMENT
                        </h1>
                        
                        <div class="row g-4 mb-4">
                            <div class="col-md-4">
                                <div class="metric-card">
                                    <h6 class="text-muted">Total Value</h6>
                                    <div class="metric-value text-trading-primary">$109,329.05</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="metric-card">
                                    <h6 class="text-muted">Available Cash</h6>
                                    <div class="metric-value text-trading-success">$25,670.45</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="metric-card">
                                    <h6 class="text-muted">Open Positions</h6>
                                    <div class="metric-value text-trading-warning">17</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0 text-trading-primary">
                                    <i class="bi bi-trophy"></i> Top Holdings
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-dark table-striped table-hover">
                                        <thead>
                                            <tr>
                                                <th>Symbol</th>
                                                <th>Value</th>
                                                <th>Weight</th>
                                                <th>Change</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td class="text-trading-primary fw-bold">NVDA</td>
                                                <td>$29,630</td>
                                                <td>27.1%</td>
                                                <td class="text-trading-success">+5.7%</td>
                                            </tr>
                                            <tr>
                                                <td class="text-trading-primary fw-bold">MSFT</td>
                                                <td>$30,964</td>
                                                <td>28.3%</td>
                                                <td class="text-trading-success">+2.1%</td>
                                            </tr>
                                            <tr>
                                                <td class="text-trading-primary fw-bold">META</td>
                                                <td>$20,238</td>
                                                <td>18.5%</td>
                                                <td class="text-trading-success">+3.8%</td>
                                            </tr>
                                            <tr>
                                                <td class="text-trading-primary fw-bold">AAPL</td>
                                                <td>$11,705</td>
                                                <td>10.7%</td>
                                                <td class="text-trading-success">+1.2%</td>
                                            </tr>
                                            <tr>
                                                <td class="text-trading-primary fw-bold">GOOGL</td>
                                                <td>$4,874</td>
                                                <td>4.5%</td>
                                                <td class="text-trading-danger">-1.8%</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ML Models -->
                    <div class="tab-pane fade" id="ml">
                        <h1 class="text-trading-primary mb-4">
                            <i class="bi bi-robot"></i> MACHINE LEARNING MODELS
                        </h1>
                        
                        <div class="row g-4">
                            <div class="col-md-6">
                                <div class="card card-success">
                                    <div class="card-body text-center">
                                        <h5 class="text-trading-success">
                                            <i class="bi bi-graph-up"></i> LSTM Neural Network
                                        </h5>
                                        <p class="metric-value text-white">89.2%</p>
                                        <p class="text-muted">Status: Active • Predictions: 2,847</p>
                                        <span class="badge bg-success">ACTIVE</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card card-primary">
                                    <div class="card-body text-center">
                                        <h5 class="text-trading-primary">
                                            <i class="bi bi-bullseye"></i> Random Forest
                                        </h5>
                                        <p class="metric-value text-white">84.7%</p>
                                        <p class="text-muted">Status: Active • Predictions: 1,923</p>
                                        <span class="badge bg-info">ACTIVE</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card card-warning">
                                    <div class="card-body text-center">
                                        <h5 class="text-trading-warning">
                                            <i class="bi bi-bar-chart"></i> Gradient Boosting
                                        </h5>
                                        <p class="metric-value text-white">Training... 67%</p>
                                        <p class="text-muted">ETA: 12 minutes remaining</p>
                                        <span class="badge bg-warning text-dark">TRAINING</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card card-danger">
                                    <div class="card-body text-center">
                                        <h5 class="text-trading-purple">
                                            <i class="bi bi-cpu"></i> Transformer Model
                                        </h5>
                                        <p class="metric-value text-white">91.8%</p>
                                        <p class="text-muted">Status: Active • Predictions: 4,156</p>
                                        <span class="badge bg-danger">PREMIUM</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Grok AI -->
                    <div class="tab-pane fade" id="grok">
                        <h1 class="text-trading-primary mb-4">
                            <i class="bi bi-brain"></i> GROK AI RECOMMENDATIONS
                        </h1>
                        
                        <div class="card mb-4">
                            <div class="card-body">
                                <div class="row text-center">
                                    <div class="col-md-4">
                                        <h6 class="text-trading-primary">
                                            <i class="bi bi-cpu"></i> AI Status
                                        </h6>
                                        <p class="text-trading-success">Online & Processing</p>
                                    </div>
                                    <div class="col-md-4">
                                        <h6 class="text-trading-primary">
                                            <i class="bi bi-bar-chart"></i> Confidence
                                        </h6>
                                        <p class="text-trading-success fs-4 fw-bold">94.7%</p>
                                    </div>
                                    <div class="col-md-4">
                                        <h6 class="text-trading-primary">
                                            <i class="bi bi-bullseye"></i> Active Signals
                                        </h6>
                                        <p class="text-trading-warning fs-4 fw-bold">8 Recommendations</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <h5 class="text-trading-primary mb-3">
                            <i class="bi bi-rocket"></i> Top AI Recommendations
                        </h5>
                        
                        <div class="grok-card buy">
                            <div class="row align-items-center">
                                <div class="col-md-2 text-center">
                                    <h4 class="text-trading-primary">NVDA</h4>
                                    <span class="badge bg-success">BUY</span>
                                </div>
                                <div class="col-md-10">
                                    <p><strong>Current:</strong> $1,185 | <strong class="text-trading-primary">Target:</strong> $1,350</p>
                                    <p><strong>Confidence:</strong> 96.2%</p>
                                    <p><strong><i class="bi bi-brain"></i> Analysis:</strong> KI-Boom und starke Quartalszahlen erwartet</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grok-card buy">
                            <div class="row align-items-center">
                                <div class="col-md-2 text-center">
                                    <h4 class="text-trading-primary">AAPL</h4>
                                    <span class="badge bg-success">BUY</span>
                                </div>
                                <div class="col-md-10">
                                    <p><strong>Current:</strong> $234 | <strong class="text-trading-primary">Target:</strong> $260</p>
                                    <p><strong>Confidence:</strong> 89.3%</p>
                                    <p><strong><i class="bi bi-brain"></i> Analysis:</strong> iPhone 16 Launch läuft gut, Services stabil</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grok-card hold">
                            <div class="row align-items-center">
                                <div class="col-md-2 text-center">
                                    <h4 class="text-trading-primary">TSLA</h4>
                                    <span class="badge bg-warning text-dark">HOLD</span>
                                </div>
                                <div class="col-md-10">
                                    <p><strong>Current:</strong> $249 | <strong class="text-trading-primary">Target:</strong> $280</p>
                                    <p><strong>Confidence:</strong> 78.5%</p>
                                    <p><strong><i class="bi bi-brain"></i> Analysis:</strong> Autopilot Updates positiv, aber Bewertung hoch</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Trading -->
                    <div class="tab-pane fade" id="trading">
                        <h1 class="text-trading-primary mb-4">
                            <i class="bi bi-graph-up"></i> TRADING TERMINAL
                        </h1>
                        
                        <div class="row g-4 mb-4">
                            <div class="col-md-4">
                                <div class="metric-card card-success">
                                    <h6 class="text-muted">Buying Power</h6>
                                    <div class="metric-value text-trading-success">$25,670</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="metric-card card-primary">
                                    <h6 class="text-muted">Day P&L</h6>
                                    <div class="metric-value text-trading-success">+$2,847</div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="metric-card card-warning">
                                    <h6 class="text-muted">Open Orders</h6>
                                    <div class="metric-value text-trading-warning">3</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card">
                            <div class="card-header">
                                <h5 class="mb-0 text-trading-primary">
                                    <i class="bi bi-bullseye"></i> ORDER ENTRY SYSTEM
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-md-6">
                                        <h6 class="mb-3">Symbol: AAPL</h6>
                                        <p class="text-trading-primary fw-bold">Current Price: $234.10</p>
                                        <p>Quantity: 10 shares</p>
                                        <p class="text-muted">Order Value: $2,341.00</p>
                                    </div>
                                    <div class="col-md-6 text-center">
                                        <button class="btn btn-trading-success mb-2 d-block w-100">
                                            <i class="bi bi-plus-circle"></i> BUY ORDER
                                        </button>
                                        <button class="btn btn-trading-danger d-block w-100">
                                            <i class="bi bi-dash-circle"></i> SELL ORDER
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="alert alert-warning mt-4">
                                    <h6 class="alert-heading">
                                        <i class="bi bi-exclamation-triangle"></i> Risk Assessment
                                    </h6>
                                    <p class="mb-1">Position Size: 2.1% of Portfolio • Risk Level: LOW</p>
                                    <p class="mb-0 text-trading-success">
                                        <i class="bi bi-brain"></i> Grok AI Recommendation: BUY (89.3% Confidence)
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Sidebar Watchlist -->
            <div class="col-lg-3">
                <div class="card sticky-top">
                    <div class="card-header">
                        <h5 class="mb-0 text-trading-primary">
                            <i class="bi bi-bar-chart"></i> LIVE WATCHLIST
                        </h5>
                    </div>
                    <div class="card-body">
                        <div id="watchlist">
                            <div class="watchlist-item positive">
                                <div>
                                    <div class="text-trading-primary fw-bold">AAPL</div>
                                    <small class="text-muted">$234.10</small>
                                </div>
                                <div class="text-trading-success fw-bold">+1.2%</div>
                            </div>
                            
                            <div class="watchlist-item positive">
                                <div>
                                    <div class="text-trading-primary fw-bold">NVDA</div>
                                    <small class="text-muted">$1,185.20</small>
                                </div>
                                <div class="text-trading-success fw-bold">+5.7%</div>
                            </div>
                            
                            <div class="watchlist-item positive">
                                <div>
                                    <div class="text-trading-primary fw-bold">MSFT</div>
                                    <small class="text-muted">$412.85</small>
                                </div>
                                <div class="text-trading-success fw-bold">+2.1%</div>
                            </div>
                            
                            <div class="watchlist-item negative">
                                <div>
                                    <div class="text-trading-primary fw-bold">GOOGL</div>
                                    <small class="text-muted">$162.45</small>
                                </div>
                                <div class="text-trading-danger fw-bold">-1.8%</div>
                            </div>
                            
                            <div class="watchlist-item negative">
                                <div>
                                    <div class="text-trading-primary fw-bold">TSLA</div>
                                    <small class="text-muted">$248.75</small>
                                </div>
                                <div class="text-trading-danger fw-bold">-2.3%</div>
                            </div>
                            
                            <div class="watchlist-item positive">
                                <div>
                                    <div class="text-trading-primary fw-bold">META</div>
                                    <small class="text-muted">$578.23</small>
                                </div>
                                <div class="text-trading-success fw-bold">+3.4%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Backend Integration -->
    <script src="AutoTradingBackend-Fixed.js"></script>
    
    <script>
        // Auto-Trading System Variables
        let autoTradingActive = false;
        let currentStrategy = 'CONSERVATIVE';
        
        // Dark/Light Mode Toggle
        function toggleTheme() {
            const html = document.documentElement;
            const icon = document.getElementById('theme-icon');
            
            if (html.getAttribute('data-bs-theme') === 'dark') {
                html.setAttribute('data-bs-theme', 'light');
                icon.className = 'bi bi-sun-fill';
            } else {
                html.setAttribute('data-bs-theme', 'dark');
                icon.className = 'bi bi-moon-fill';
            }
        }
        
        // Strategy Selection
        function selectStrategy(strategy) {
            currentStrategy = strategy;
            
            // Update visual selection
            document.querySelectorAll('.strategy-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.target.closest('.strategy-card').classList.add('selected');
            
            console.log('📈 Trading-Strategie geändert zu:', strategy);
            
            // Send to backend if available
            if (window.autoTradingBackend) {
                autoTradingBackend.setTradingStrategy(strategy).then(success => {
                    if (success) {
                        console.log('✅ Strategy updated in backend:', strategy);
                    }
                });
            }
        }
        
        // Toggle Auto-Trading
        function toggleAutoTradingReal() {
            if (!window.autoTradingBackend) {
                showAlert('🚨 Backend not initialized!', 'danger');
                return;
            }
            
            if (!autoTradingBackend.isBackendConnected()) {
                showAlert('🚨 Backend not connected!', 'danger');
                return;
            }
            
            autoTradingActive = !autoTradingActive;
            
            // Update UI immediately
            updateTradingUI();
            
            // Send command to backend
            autoTradingBackend.enableAutoTrading(autoTradingActive).then(success => {
                if (success) {
                    console.log(`🚀 Backend command sent: ${autoTradingActive ? 'START' : 'STOP'} auto-trading`);
                    showAlert(`Auto-Trading ${autoTradingActive ? 'STARTED' : 'STOPPED'}`, 
                             autoTradingActive ? 'success' : 'warning');
                } else {
                    // Revert state on failure
                    autoTradingActive = !autoTradingActive;
                    updateTradingUI();
                    showAlert('🚨 Failed to communicate with backend!', 'danger');
                }
            });
        }
        
        // Emergency Stop
        function emergencyStopReal() {
            if (!window.autoTradingBackend) {
                showAlert('🚨 Backend not available for emergency stop!', 'danger');
                return;
            }
            
            console.log('🛑 EMERGENCY STOP INITIATED');
            
            autoTradingBackend.emergencyStopAll().then(success => {
                if (success) {
                    autoTradingActive = false;
                    updateTradingUI();
                    showAlert('🛑 EMERGENCY STOP AKTIVIERT!', 'danger');
                } else {
                    showAlert('⚠️ Emergency stop communication failed!', 'warning');
                }
            });
        }
        
        // Update Trading UI
        function updateTradingUI() {
            const statusElement = document.getElementById('tradingStatus');
            const textElement = document.getElementById('tradingText');
            const ledElement = document.getElementById('tradingLed');
            const buttonElement = document.getElementById('startTradingBtn');
            
            if (autoTradingActive) {
                statusElement.className = 'trading-status-display active';
                textElement.textContent = '🤖 AUTO-TRADING AKTIV';
                ledElement.className = 'status-dot';
                buttonElement.innerHTML = '<i class="bi bi-pause-fill"></i> TRADING STOPPEN';
                buttonElement.className = 'btn btn-trading-danger btn-lg px-5 py-3';
            } else {
                statusElement.className = 'trading-status-display inactive';
                textElement.textContent = '⏸️ AUTO-TRADING GESTOPPT';
                ledElement.className = 'status-dot danger';
                buttonElement.innerHTML = '<i class="bi bi-play-fill"></i> TRADING STARTEN';
                buttonElement.className = 'btn btn-trading-success btn-lg px-5 py-3';
            }
        }
        
        // Show Bootstrap Alert
        function showAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
            alertDiv.style.cssText = 'top: 100px; right: 20px; z-index: 1050; max-width: 400px;';
            alertDiv.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(alertDiv);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }
        
        // Update Backend Status
        function updateBackendStatus(connected, mode) {
            const statusElement = document.getElementById('backendStatus');
            const textElement = document.getElementById('backendStatusText');
            
            console.log(`📡 Updating backend status: connected=${connected}, mode=${mode}`);
            
            if (connected) {
                statusElement.className = 'alert alert-success';
                
                if (mode === 'qml') {
                    textElement.innerHTML = '<i class="bi bi-cpu"></i> 🟢 QML Redis Client Connected';
                } else if (mode === 'redis-direct') {
                    textElement.innerHTML = '<i class="bi bi-wifi"></i> 🟢 Redis Backend Connected (Port 6380)';
                } else if (mode === 'simulation') {
                    textElement.innerHTML = '<i class="bi bi-play-circle"></i> 🟡 Simulation Mode Active';
                } else {
                    textElement.innerHTML = '<i class="bi bi-check-circle"></i> 🟢 Backend Connected';
                }
            } else {
                statusElement.className = 'alert alert-warning';
                textElement.innerHTML = '<i class="bi bi-wifi-off"></i> � Connecting to Backend...';
            }
        }
        
        // Live Watchlist Updates
        function updateWatchlist() {
            const watchlistItems = document.querySelectorAll('.watchlist-item');
            watchlistItems.forEach(item => {
                const changeElement = item.querySelector('.fw-bold:last-child');
                if (changeElement) {
                    const currentChange = parseFloat(changeElement.textContent.replace('%', ''));
                    const newChange = currentChange + (Math.random() - 0.5) * 0.4;
                    
                    changeElement.textContent = (newChange >= 0 ? '+' : '') + newChange.toFixed(1) + '%';
                    changeElement.className = newChange >= 0 ? 'text-trading-success fw-bold' : 'text-trading-danger fw-bold';
                    item.className = newChange >= 0 ? 'watchlist-item positive' : 'watchlist-item negative';
                }
            });
        }
        
        // Chart Configuration
        let portfolioChart, allocationChart, tradingChart;
        
        function initializeCharts() {
            // Check if Chart.js is loaded
            if (typeof Chart === 'undefined') {
                console.error('❌ Chart.js not loaded, retrying in 2 seconds...');
                setTimeout(initializeCharts, 2000);
                return;
            }
            
            console.log('📊 Initializing charts with Chart.js version:', Chart.version);
            
            // Portfolio Performance Chart
            const portfolioCtx = document.getElementById('portfolioChart')?.getContext('2d');
            if (!portfolioCtx) {
                console.error('❌ Portfolio chart canvas not found');
                return;
            }
            
            portfolioChart = new Chart(portfolioCtx, {
                type: 'line',
                data: {
                    labels: generateTimeLabels(24),
                    datasets: [{
                        label: 'Portfolio Value ($)',
                        data: generatePortfolioData(),
                        borderColor: '#00ffff',
                        backgroundColor: 'rgba(0, 255, 255, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#00ffff',
                        pointBorderColor: '#ffffff',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            labels: { color: '#ffffff' }
                        }
                    },
                    scales: {
                        x: { 
                            ticks: { color: '#888888' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        y: { 
                            ticks: { color: '#888888' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        }
                    }
                }
            });
            
            // Asset Allocation Pie Chart
            const allocationCtx = document.getElementById('allocationChart').getContext('2d');
            allocationChart = new Chart(allocationCtx, {
                type: 'doughnut',
                data: {
                    labels: ['NVDA', 'MSFT', 'META', 'AAPL', 'GOOGL', 'Others'],
                    datasets: [{
                        data: [27.1, 28.3, 18.5, 10.7, 4.5, 10.9],
                        backgroundColor: [
                            '#00ff00',
                            '#00ffff', 
                            '#ffaa00',
                            '#ff6b6b',
                            '#9b59b6',
                            '#95a5a6'
                        ],
                        borderColor: '#ffffff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            position: 'bottom',
                            labels: { 
                                color: '#ffffff',
                                padding: 15,
                                usePointStyle: true
                            }
                        }
                    }
                }
            });
            
            // Trading Volume Chart
            const tradingCtx = document.getElementById('tradingChart')?.getContext('2d');
            if (!tradingCtx) {
                console.error('❌ Trading chart canvas not found');
                return;
            }
            
            tradingChart = new Chart(tradingCtx, {
                type: 'bar',
                data: {
                    labels: ['NVDA', 'AAPL', 'MSFT', 'META', 'GOOGL', 'TSLA', 'AMZN', 'NFLX'],
                    datasets: [{
                        label: 'Trading Volume ($)',
                        data: [15000, 12000, 18000, 8000, 5000, 9000, 7000, 4000],
                        backgroundColor: 'rgba(0, 255, 0, 0.6)',
                        borderColor: '#00ff00',
                        borderWidth: 2
                    }, {
                        label: 'ML Confidence (%)',
                        data: [96, 89, 84, 92, 78, 85, 81, 76],
                        type: 'line',
                        borderColor: '#ffaa00',
                        backgroundColor: 'rgba(255, 170, 0, 0.1)',
                        borderWidth: 3,
                        tension: 0.4,
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            labels: { color: '#ffffff' }
                        }
                    },
                    scales: {
                        x: { 
                            ticks: { color: '#888888' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        y: { 
                            type: 'linear',
                            position: 'left',
                            ticks: { color: '#888888' },
                            grid: { color: 'rgba(255, 255, 255, 0.1)' }
                        },
                        y1: {
                            type: 'linear',
                            position: 'right',
                            ticks: { color: '#888888' },
                            grid: { display: false },
                            min: 0,
                            max: 100
                        }
                    }
                }
            });
        }
        
        function generateTimeLabels(hours) {
            const labels = [];
            const now = new Date();
            for (let i = hours; i >= 0; i--) {
                const time = new Date(now.getTime() - i * 60 * 60 * 1000);
                labels.push(time.getHours().toString().padStart(2, '0') + ':00');
            }
            return labels;
        }
        
        function generatePortfolioData() {
            const data = [];
            let value = 106500;
            for (let i = 0; i < 25; i++) {
                value += (Math.random() - 0.5) * 1000;
                data.push(Math.round(value));
            }
            return data;
        }
        
        function updateChartsData() {
            if (portfolioChart) {
                // Update portfolio chart with new data
                portfolioChart.data.datasets[0].data = generatePortfolioData();
                portfolioChart.update('none');
            }
        }

        // Backend Status Bridge - Simplified
        function initializeBackendConnection() {
            console.log('🔗 Initializing backend connection...');
            
            // Prüfe verschiedene globale Variablen
            const backend = window.AutoTradingBackend || window.autoTradingBackend;
            
            if (backend && typeof backend.testConnection === 'function') {
                console.log('✅ AutoTradingBackend found');
                window.autoTradingBackend = backend;
                
                // Test connection with error handling
                try {
                    backend.testConnection().then(result => {
                        console.log('🔍 Backend connection test result:', result);
                        
                        if (result && result.connected) {
                            updateBackendStatus(true, result.type || 'simulation');
                            showAlert(`🟢 Backend Connected (${result.type || 'simulation'})`, 'success');
                        } else {
                            updateBackendStatus(false);
                            showAlert('� Using Simulation Mode', 'warning');
                        }
                    }).catch(error => {
                        console.error('❌ Backend connection test failed:', error);
                        updateBackendStatus(false);
                        showAlert('� Fallback to Simulation Mode', 'warning');
                    });
                } catch(error) {
                    console.error('❌ Backend test error:', error);
                    updateBackendStatus(false);
                    showAlert('� Simulation Mode Active', 'warning');
                }
                
            } else {
                console.log('⚠️ AutoTradingBackend not ready, retrying...');
                
                // Retry with exponential backoff (max 5 attempts)
                const retryCount = window.backendRetryCount || 0;
                if (retryCount < 5) {
                    window.backendRetryCount = retryCount + 1;
                    const delay = Math.min(1000 * Math.pow(2, retryCount), 5000); // 1s, 2s, 4s, 5s, 5s
                    setTimeout(initializeBackendConnection, delay);
                } else {
                    console.log('✅ Switching to Simulation Mode');
                    updateBackendStatus(true, 'simulation');
                    showAlert('🟡 Simulation Mode Active', 'info');
                }
            }
        }
        
        // Manual Backend Connection Tester (for debugging)
        function testBackendConnection() {
            console.log('🧪 Manual backend connection test...');
            
            if (window.autoTradingBackend) {
                window.autoTradingBackend.testConnection().then(result => {
                    console.log('✅ Manual test result:', result);
                    updateBackendStatus(result.connected, result.type);
                    showAlert(`Test: ${result.connected ? 'Connected' : 'Failed'}`, 
                             result.connected ? 'success' : 'warning');
                });
            } else {
                console.log('❌ No backend available for testing');
                showAlert('❌ No Backend Available', 'danger');
            }
        }

        // Initialize with proper loading sequence
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 6bot Bootstrap 5 Trading Suite loading...');
            
            // Step 1: Initialize basic UI
            updateTradingUI();
            
            // Step 2: Wait for external scripts to load
            setTimeout(() => {
                // Initialize charts after Chart.js loads
                initializeCharts();
                
                // Initialize backend connection
                initializeBackendConnection();
                
                console.log('✅ All systems initialized');
            }, 1500);
            
            // Step 3: Start periodic updates
            setTimeout(() => {
                // Start watchlist updates
                setInterval(updateWatchlist, 3000);
                
                // Update charts every 30 seconds
                setInterval(updateChartsData, 30000);
                
                console.log('🔄 Periodic updates started');
            }, 2000);
        });
        
        // QML-HTML Bridge (if running in QML WebView)
        window.qmlBridge = null;
        
        function onQMLBridgeReady(bridge) {
            console.log('✅ QML Bridge ready:', bridge);
            window.qmlBridge = bridge;
            
            // Show QML mode indicator
            showAlert('🔗 QML Hybrid Mode Active', 'info');
        }
        
        function updateFromQML(data) {
            console.log('📡 Received update from QML:', data);
            
            // Update auto-trading state
            autoTradingActive = data.autoTradingEnabled;
            currentStrategy = data.currentStrategy;
            
            updateTradingUI();
            
            // Update strategy selection
            document.querySelectorAll('.strategy-card').forEach(card => {
                card.classList.remove('selected');
                if (card.textContent.includes(currentStrategy)) {
                    card.classList.add('selected');
                }
            });
        }
    </script>
</body>
</html>